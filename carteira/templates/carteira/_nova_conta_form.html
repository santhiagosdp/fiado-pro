{# templates/carteira/_nova_conta_form.html #}
<div class="row g-3">
  <div class="col-md-6">
    <label class="form-label fw-semibold">Cliente</label>
    {{ cliente_form.nome }}
  </div>
  <div class="col-md-3">
    <label class="form-label fw-semibold">CPF/CNPJ</label>
    {{ cliente_form.cpf }}
  </div>
  <div class="col-md-3">
    <label class="form-label fw-semibold">Telefone</label>
    {{ cliente_form.telefone }}
  </div>

  <div class="col-md-4">
    <label class="form-label fw-semibold">Vencimento</label>
    {{ conta_form.vencimento }}
  </div>

  {# Itens (formset) #}
  <div class="col-12">
    <div class="border rounded p-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <strong>Itens</strong>
        <button type="button" class="btn btn-sm btn-outline-dark" onclick="addItem()">+ Item</button>
      </div>
      {{ item_formset.management_form }}
      <div id="itens-wrap">
        {% for form in item_formset %}
          <div class="row g-2 align-items-end mb-2 item-row">
            <div class="col-md-6">
              <label class="form-label">Produto</label>
              {{ form.produto }}
            </div>
            <div class="col-md-3">
              <label class="form-label">Quantidade</label>
              {{ form.quantidade }}
            </div>
            <div class="col-md-3">
              <label class="form-label">Valor Unit. (R$)</label>
              {{ form.valor_unit }}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<script>
function addItem() {
  // duplica o Ãºltimo item de forma simples (poderemos refinar depois)
  const wrap = document.getElementById('itens-wrap');
  const rows = wrap.querySelectorAll('.item-row');
  if (!rows.length) return;
  const last = rows[rows.length - 1];
  const clone = last.cloneNode(true);
  // limpa valores
  clone.querySelectorAll('input').forEach(i => i.value = '');
  wrap.appendChild(clone);
}
</script>
